function check = test_rerun()

N = 100;
A = -5*gallery('grcar',N,3);
b = ones(N,1);
xi = [5.0523-29.5113i, ...
      5.0523+29.5113i, ...
      9.3187-25.2383i, ...
      9.3187+25.2383i, ...
      12.1265-21.3194i, ...
      12.1265+21.3194i, ...
      14.0793-17.5109i, ...
      14.0793+17.5109i, ...
      15.4216-13.7162i, ...
      15.4216+13.7162i, ...
      16.2942-9.8809i, ...
      16.2942+9.8809i, ...
      16.8005-5.9755i, ...
      16.8005+5.9755i, ...
      17.0261-2.0016i, ...
      17.0261+2.0016i];
[V, K, H] = rat_krylov(A, b, xi,'real');

nrm1 = norm(A*V*K-V*H)/norm(H);
nrm2 = norm(V'*V-eye(size(V, 2)));
[Vr, Kr, Hr] = rat_krylov(A, b/norm(b), K, H); % rerun test with same A,v
nrm3 = norm(V-Vr);
nrm4 = norm(A*Vr*Kr-Vr*Hr)/norm(Hr);
A = diag(exp(1i*linspace(0,2*pi,N)));
v = ones(N,1); v(1:5) = v(1:5)*(1 - 7i); % rerun with complex A and v
[Vrr, Krr, Hrr] = rat_krylov(A, v, K, H); 
nrm5 = norm(A*Vrr*Krr-Vrr*Hrr)/norm(Hrr);
check = [nrm1,nrm2,nrm3,nrm4,nrm5] < 1e-13;
